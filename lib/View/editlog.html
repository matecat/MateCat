<!DOCTYPE HTML>
<html lang="en">
    <head>
        <meta charset="utf-8"/>
        <title>Editing log - Matecat</title>
        <meta name="description" content="Matecat allows you to get more matches than any other CAT tool."/>
        <meta name="viewport" content="width=device-width"/>
        <div metal:use-macro="${php: INIT::$TRACKING_CODES_VIEW_PATH}/external_sources.html/header_common"/>
        <link href="${basepath}public/css/build/common.css?build=${build_number}" rel="stylesheet" type="text/css"/>
        <link href="${basepath}public/css/build/app.css?build=${build_number}" rel="stylesheet" type="text/css"/>
        <link href="${basepath}public/css/build/semantic.css?build=${build_number}" rel="stylesheet" type="text/css" />
        <link rel="stylesheet" href="${basepath}public/css/build/legacy-misc.css?build=${build_number}"/>

        <script type="text/javascript">
            var config = {
                basepath: '${basepath | string:/}'
            };
        </script>

        <script type="text/javascript" src="${basepath}public/js/build/libs.js?build=${build_number}"></script>
        <script type="text/javascript" src="${basepath}public/js/lib/semantic.min.js"></script>
    </head>

    <body class="editlog" tal:condition="not:supportedBrowser">
        <div  metal:use-macro="unsupported_browser.html/unsupported"/>
    </body>

    <body tal:condition="true:job_archived">
        <div metal:use-macro="unsupported_browser.html/job_archived"/>
    </body>

    <body class="editlog" tal:condition="php: supportedBrowser NE 0 && !job_archived">

        <header>
            <div class="wrapper">
                <div class="logo-menu">
                    <a href="${basepath}" class="logo">
                    </a>
                </div> <!-- .logo-menu -->

                <div class="header-el-placeholder"></div>
                <div class="header-el-placeholder"></div>
                <div class="header-el-placeholder"></div>

                <div class="profile-menu">
                    <div class="column-separator"></div>
                    <div tal:condition="isLoggedIn">
                        <a href="/manage" id="action-manage">
                            <svg width="36px" height="36px" viewBox="0 0 42 42" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                                <defs>
                                    <polygon id="path-1" points="0 -0.0002 21 -0.0002 21 21 0 21"/>
                                    <polygon id="path-3" points="0 0.323 3.9997 0.323 3.9997 4.3226 0 4.3226"/>
                                    <polygon id="path-5" points="0 0.1166 3.9997 0.1166 3.9997 4.1166 0 4.1166"/>
                                    <polygon id="path-7" points="0 0.0004 3.9997 0.0004 3.9997 4.0004 0 4.0004"/>
                                </defs>
                                <g id="icon-manage" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                                    <g id="Group-19" transform="translate(2.000000, 9.000000)">
                                        <path d="M22.5,9.7771 C22.5,9.1771 22.1,8.7771 21.5,8.7771 L9,8.7771 C8.4,8.7771 8,9.1771 8,9.7771 C8,10.3771 8.4,10.7771 9,10.7771 L21.5,10.7771 C22.1,10.7771 22.5,10.3771 22.5,9.7771" id="Fill-1" fill="#FFFFFF"/>
                                        <path d="M9,3.6775 L23,3.6775 C23.6,3.6775 24,3.2775 24,2.6775 C24,2.0765 23.6,1.6775 23,1.6775 L9,1.6775 C8.4,1.6775 8,2.0765 8,2.6775 C8,3.2775 8.4,3.6775 9,3.6775" id="Fill-3" fill="#FFFFFF"/>
                                        <path d="M9,15.6775 C8.4,15.6775 8,16.0765 8,16.6775 C8,17.2775 8.4,17.6775 9,17.6775 L15,17.6775 C15.6,17.6775 16,17.2775 16,16.6775 C16,16.0765 15.6,15.6775 15,15.6775 L9,15.6775 Z" id="Fill-5" fill="#FFFFFF"/>
                                        <g id="Group-9" transform="translate(17.000000, 2.677100)">
                                            <mask id="mask-2" fill="white">
                                                <use xlink:href="#path-1"></use>
                                            </mask>
                                            <g id="Clip-8"></g>
                                            <path d="M2,17.3998 L17,2.3998 L18.6,4.0008 L3.6,19.0008 L2,19.0008 L2,17.3998 Z M1,21.0008 L4,21.0008 C4.3,21.0008 4.5,20.8998 4.7,20.6998 L20.7,4.6998 C21.1,4.2998 21.1,3.6998 20.7,3.2998 L17.7,0.2998 C17.3,-0.1002 16.7,-0.1002 16.3,0.2998 L0.3,16.2998 C0.1,16.5008 0,16.6998 0,17.0008 L0,20.0008 C0,20.5998 0.4,21.0008 1,21.0008 L1,21.0008 Z" id="Fill-7" fill="#FFFFFF" mask="url(#mask-2)"></path>
                                        </g>
                                        <g id="Group-12" transform="translate(0.000000, 0.677100)">
                                            <mask id="mask-4" fill="white">
                                                <use xlink:href="#path-3"></use>
                                            </mask>
                                            <g id="Clip-11"></g>
                                            <path d="M1.0347,4.3226 L2.9657,4.3226 C3.5367,4.3226 3.9997,3.8596 3.9997,3.2886 L3.9997,1.3576 C3.9997,0.7856 3.5367,0.3226 2.9657,0.3226 L1.0347,0.3226 C0.4637,0.3226 -0.0003,0.7856 -0.0003,1.3576 L-0.0003,3.2886 C-0.0003,3.8596 0.4637,4.3226 1.0347,4.3226" id="Fill-10" fill="#FFFFFF" mask="url(#mask-4)"></path>
                                        </g>
                                        <g id="Group-15" transform="translate(0.000000, 7.677100)">
                                            <mask id="mask-6" fill="white">
                                                <use xlink:href="#path-5"></use>
                                            </mask>
                                            <g id="Clip-14"></g>
                                            <path d="M1.0347,4.1166 L2.9657,4.1166 C3.5367,4.1166 3.9997,3.6536 3.9997,3.0826 L3.9997,1.1506 C3.9997,0.5796 3.5367,0.1166 2.9657,0.1166 L1.0347,0.1166 C0.4637,0.1166 -0.0003,0.5796 -0.0003,1.1506 L-0.0003,3.0826 C-0.0003,3.6536 0.4637,4.1166 1.0347,4.1166" id="Fill-13" fill="#FFFFFF" mask="url(#mask-6)"></path>
                                        </g>
                                        <g id="Group-18" transform="translate(0.000000, 14.677100)">
                                            <mask id="mask-8" fill="white">
                                                <use xlink:href="#path-7"></use>
                                            </mask>
                                            <g id="Clip-17"></g>
                                            <path d="M1.0347,4.0004 L2.9657,4.0004 C3.5367,4.0004 3.9997,3.5364 3.9997,2.9654 L3.9997,1.0344 C3.9997,0.4634 3.5367,0.0004 2.9657,0.0004 L1.0347,0.0004 C0.4637,0.0004 -0.0003,0.4634 -0.0003,1.0344 L-0.0003,2.9654 C-0.0003,3.5364 0.4637,4.0004 1.0347,4.0004" id="Fill-16" fill="#FFFFFF" mask="url(#mask-8)"></path>
                                        </g>
                                    </g>
                                </g>
                            </svg>
                        </a>
                    </div>
                    <div metal:use-macro="common.html/login_includes" />
                </div> <!-- .profile-menu -->

            </div>
        </header>

        <div class="wrapper" tal:condition="emptyJob">
                <div id="projects">
                    <p class="article msg">
                        <i>There are no edited segments in this job.</i>
                    </p>
                </div>

        </div>

        <div class="wrapper" tal:condition="not: emptyJob">

            <!--	<h1>Field test - 1</h1> -->

            <h1 style="margin-bottom:0px">Editing Log - Project: <span id="pname" tal:content="pname">Project</span></h1>

            <h2 style="margin-top:20px;margin-bottom:10px">
                Stats for translation job <span tal:replace="jid | default"></span> -
                <b><span tal:replace="source_code">---</span> </b> &gt; <b>
                    <span tal:replace="target_code">---</span></b>
            </h2>


            <table class="tablestats continue" width="100%" border="0" cellspacing="0" cellpadding="0">
                <tr>
                    <th>Words</th>
                    <th>Total Time-to-edit <a class="tooltip">?<span>Sum of the time to edit of all segments, including translators' pauses.</span></a></th>
                    <th>Your avg secs/word</th>
                    <th>Your avg PEE</th>
                </tr>
                <tr>
                    <td tal:content="stats/valid-word-count | default">N/A</td>
                    <td><span tal:replace="stats/total-valid-tte | string:--"></span></td>
                    <td tal:attributes="class php:tte_fast ? 'color_green' : NULL">
                        <span tal:condition="tte_fast"><b><i>You're fast!</i></b></span>
                        <span tal:replace="stats/avg-secs-per-word | string:--"></span>s
                        <!--<small style="color:#000">(other users: <span tal:replace="overall_tte | string:&#45;&#45;"></span>s)</small>-->
                    </td>
                    <td tal:attributes="class php:pee_slow ? 'bg_orange' : NULL" >
                        <span tal:replace="stats/avg-pee | string:--"></span>
                        <!--<small>(other users: <span tal:replace="overall_pee | string:&#45;&#45;"></span>%)</small>-->
                    </td>
                </tr>
            </table>
            <form action="${basepath}" method="post">
                <input type="hidden" name="action" value="editlogDownload"/>
                <input type="hidden" name="jid" tal:attributes="value jid" value=""/>
                <input type="hidden" name="password" tal:attributes="value password" value=""/>

                <span class="pull-right" id="export_edit_log_csv_link">(<a  name="submit" value="Export All Data in CSV" href="javascript:;" onclick="parentNode.parentNode.submit();">Export detailed log as CSV</a>)</span>
                <span class="clearfix"></span>
            </form>

            <h2 style="margin-top:20px;margin-bottom:10px">Editing Details</h2>

            <!-- to be completed
            <div id="sort_box" class="translate-box">
                <label for="sort_select">Sort by:</label>
                <select id="sort_select">
                    <option value="seg_id">Segment ID </option>
                    <option value="secsWord_asc">Secs/Word (asc)</option>
                    <option value="secsWord_desc">Secs/Word (desc)</option>
                    <option value="pee_asc">Post-editing effort (asc)</option>
                    <option value="pee_desc">Post-editing effort (desc)</option>
                    <option value="issues">Segments with issues first</option>
                </select>
            </div>
            -->

            <div tal:define="file_data php:array()" tal:repeat="file_data data">
                <span tal:attributes="class string:error-symbol" tal:condition="php:file_data['stats_valid_style'] NE '' "></span>
                <table class="tablestats continue" width="100%" border="0" cellspacing="0" cellpadding="0" tal:attributes="style string:${file_data/stats_valid_style}">

                    <tr>
                        <th>Segment ID</th>
                        <th>Words</th>
                        <th>Time-to-edit (TTE)</th>
                        <th width="100">Secs/Word</th>
                        <th>Post-editing effort (PEE)</th>
                    </tr>

                    <tr>
                        <td><a
                                tal:attributes="href string:${basepath}translate/${pname}/${source_code}-${target_code}/${jid}-${password}#${file_data/id}"><span
                                tal:replace="file_data/id | default" /></a></td>
                        <td tal:content="file_data/raw_word_count | default">N/A</td>
                        <td tal:content="file_data/display_time_to_edit"></td>
                        <td tal:content="file_data/secs_per_word | default"
                            title="A statistically relevant time-to-edit is considered to be beetween 0.25s/word and 30s/word. Red marked segments are excluded from statistics."> N/A </td>
                        <td tal:content="file_data/pe_effort_perc | default">%</td>
                        <!--<td tal:content="file_data/suggestion_source | default">N/A</td>-->
                        <!--<td tal:content="file_data/suggestion_match | default">%</td>-->
                    </tr>
                </table>

                <table class="tablestats" width="100%" border="0" cellspacing="0" cellpadding="0" tal:attributes="style string:${file_data/stats_valid_style}">

                    <tr>
                        <th style="width: 100px">Segment</th>
                        <td style="text-align:left;font-size:16px;" tal:content="structure file_data/source | default">N/A</td>
                    </tr>
                    <tr>
                        <th style="width: 100px">Suggestion<br/>
                            (<span tal:content="file_data/suggestion_source | default"></span> -
                             <span tal:content="file_data/suggestion_match | default"></span>)
                        </th>
                        <td style="text-align:left;font-size:16px;" tal:content="structure file_data/suggestion_view | default">N/A</td>
                    </tr>
                    <tr>
                        <th style="width: 100px">Translation</th>
                        <td style="text-align:left;font-size:16px;" tal:content="structure file_data/translation | default">N/A</td>

                    </tr>
                    <tr>
                        <th style="width: 100px">Diff View</th>
                        <td style="text-align:left;font-size:16px;" tal:content="structure file_data/diff | default">N/A</td>
                    </tr>
                    <tr>
                        <th style="width: 100px">QA Issues</th>
                        <td style="text-align:left;font-size:16px;" tal:content="structure file_data/warnings"></td>
                    </tr>
                    <tr tal:condition="file_data/ice_modified">
                        <th colspan="2" style="text-align:right;font-size:16px; color: red;">ICE Modified</th>
                    </tr>
                </table>

            </div>

        </div>

        <div class="notifications-wrapper"></div>


        <footer class="func-foo">
            <div class="footer-body">

                <!-- pagination -->
                <div id="pagination_box" tal:condition="not: emptyJob">
                    <nav>
                        <ul>
                            <li id="prev_page" tal:condition="exists: pagination/prev">
                                <a tal:attributes="href string:${basepath}editlog/${jid}-${password}?start=${pagination/prev}">&lt;&lt;</a>
                            </li>

                            <li id="first_page" tal:condition="exists: pagination/first">
                                <a tal:attributes="href string:${basepath}editlog/${jid}-${password}?start=${pagination/first}">
                                    1
                                </a>
                            </li>
                            <li tal:condition="php: pagination['current_page'] > 3">
                                <span>...</span>
                            </li>
                            <li tal:condition="exists: pagination/prev">
                                <a tal:attributes="href string:${basepath}editlog/${jid}-${password}?start=${pagination/prev}"
                                   tal:content="php: pagination['current_page']-1">
                                </a>
                            </li>
                            <li id="current_page" tal:condition="exists: pagination/current">
                                <a tal:attributes="href string:${basepath}editlog/${jid}-${password}?start=${pagination/current}">${pagination/current_page}</a>
                            </li>
                            <li tal:condition="exists: pagination/next">
                                <a tal:attributes="href string:${basepath}editlog/${jid}-${password}?start=${pagination/next}"
                                   tal:content="php: pagination['current_page'] +1 ">
                                </a>
                            </li>
                            <li tal:condition="php: pagination['last_page'] > pagination['current_page'] + 2">
                                <span>...</span>
                            </li>
                            <li id="last_page" tal:condition="exists: pagination/last">
                                <a tal:attributes="href string:${basepath}editlog/${jid}-${password}?start=${pagination/last}">
                                    ${pagination/last_page}
                                </a>
                            </li>
                            <li id="next_page" tal:condition="exists: pagination/next">
                                <a tal:attributes="href string:${basepath}editlog/${jid}-${password}?start=${pagination/next}">
                                    &gt;&gt;
                                </a>
                            </li>
                        </ul>
                    </nav>
                </div>

            </div> <!-- .wrapper -->
        </footer>


        <div metal:use-macro="${php: INIT::$TRACKING_CODES_VIEW_PATH}/external_sources.html/track_codes_upload"/>

        <div metal:use-macro="common.html/footer_includes" />

        <script>
            <tal:block>
                /*<![CDATA[*/

                function initLogoutAction() {
                    $('.user-menu-container').on('click', '#logout-item', function (e) {
                        e.preventDefault();
                        $.post('/api/app/user/logout', function (data) {
                            if ($('body').hasClass('manage')) {
                                location.href = config.hostpath + config.basepath;
                            } else {
                                window.location.reload();
                            }
                        });
                    });
                }

                function initProfileModal() {
                    $('#profile-item').on('click', function (e) {
                        e.preventDefault();
                        e.stopPropagation();
                        $('#modal').trigger('openpreferences');
                        return false;
                    });
                }

                function initDropdown() {
                    $('#user-menu-dropdown').dropdown();
                }

                $(document).ready(function(){
                    initLogoutAction();
                    initProfileModal();
                    initDropdown();
                });

                /*]]>*/
            </tal:block>
        </script>
        <script type="text/javascript" id="hs-script-loader" src="//js.hs-scripts.com/5642498.js"></script>
    </body>
</html>
